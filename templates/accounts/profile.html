{% extends 'base.html' %}

{% block title %}{{ profile_user.username }} - Profil{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-4">
        <div class="card">
            <div class="card-body text-center">
                {% if profile_user.profile.avatar %}
                    <img src="{{ profile_user.profile.avatar.url }}" class="rounded-circle mb-3" width="150" height="150" alt="Avatar">
                {% else %}
                    <i class="bi bi-person-circle" style="font-size: 150px;"></i>
                {% endif %}
                <h4>{{ profile_user.profile.get_display_name }}</h4>
                <p class="text-muted">@{{ profile_user.username }}</p>
                
                {% if profile_user.profile.city %}
                    <p><i class="bi bi-geo-alt"></i> {{ profile_user.profile.city }}</p>
                {% endif %}
                
                {% if profile_user.profile.bio %}
                    <p>{{ profile_user.profile.bio }}</p>
                {% endif %}
                
                {% if is_own_profile %}
                <a href="{% url 'accounts:profile_edit' %}" class="btn btn-primary">
                    <i class="bi bi-pencil"></i> Profili Düzenle
                </a>
                {% endif %}
            </div>
        </div>
        
        {% if profile_user.profile.favorite_categories %}
        <div class="card mt-3">
            <div class="card-header">
                <h5>Favori Kategoriler</h5>
            </div>
            <div class="card-body">
                {% for cat in profile_user.profile.favorite_categories %}
                    <span class="badge bg-primary">{{ cat }}</span>
                {% endfor %}
            </div>
        </div>
        {% endif %}
    </div>
    
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h5><i class="bi bi-calendar-check"></i> Gittiğim Yerler</h5>
            </div>
            <div class="card-body">
                {% if visits %}
                    {% for visit in visits %}
                    <div class="border-bottom pb-3 mb-3">
                        <div class="d-flex justify-content-between align-items-start">
                            <div class="flex-grow-1">
                                <h6>
                                    <a href="{% url 'places:place_detail' visit.place.id %}" class="text-decoration-none">
                                        {{ visit.place.name }}
                                    </a>
                                </h6>
                                <small class="text-muted">{{ visit.visited_at|date:"d M Y" }}</small>
                            </div>
                            {% if visit.sentiment %}
                            <span class="badge bg-primary ms-2">
                                {{ visit.get_sentiment_display }}
                            </span>
                            {% endif %}
                        </div>
                        
                        {% if visit.rating %}
                        <div class="mb-2">
                            <span class="rating-stars">
                                {% for i in "12345" %}
                                    {% if forloop.counter <= visit.rating %}
                                        <i class="bi bi-star-fill"></i>
                                    {% else %}
                                        <i class="bi bi-star"></i>
                                    {% endif %}
                                {% endfor %}
                            </span>
                            <small class="text-muted ms-2">{{ visit.rating }}/5</small>
                        </div>
                        {% endif %}
                        
                        {% if visit.tags %}
                        <div class="mb-2">
                            {% for tag in visit.tags %}
                                <span class="badge bg-info">{{ tag }}</span>
                            {% endfor %}
                        </div>
                        {% endif %}
                        
                        {% if visit.suitable_for %}
                        <div class="mb-2">
                            <small class="text-muted">Kiminle:</small>
                            {% for suitable in visit.suitable_for %}
                                <span class="badge bg-secondary">{{ suitable }}</span>
                            {% endfor %}
                        </div>
                        {% endif %}
                        
                        {% if visit.atmosphere %}
                        <div class="mb-2">
                            <small class="text-muted">Ortam:</small>
                            {% for atm in visit.atmosphere %}
                                <span class="badge bg-success">{{ atm }}</span>
                            {% endfor %}
                        </div>
                        {% endif %}
                        
                        {% if visit.comment %}
                        <p class="mb-2 mt-2">{{ visit.comment|truncatewords:30 }}</p>
                        {% endif %}
                    </div>
                    {% endfor %}
                {% else %}
                    <p class="text-muted">Henüz ziyaret kaydedilmemiş.</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
